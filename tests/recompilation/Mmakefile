#-----------------------------------------------------------------------------#

main_target: check

include ../Mmake.common
-include ../Mmake.params

#-----------------------------------------------------------------------------#
#-----------------------------------------------------------------------------#

clean_local:

realclean_local:
	. ./TESTS; \
	for module in $$ALL_TESTS; do \
		rm -rf $$module.m $${module}_2.m ;\
	done

should_run_recompilation_tests:
	@echo $(RUN_RECOMPILATION_TESTS)

	# typeclass_method_pragma_r calls a predicate with a
	# `:- pragma obsolete' declaration.
MCFLAGS-typeclass_method_pragma_r = --no-halt-at-warn

# Smart recompilation doesn't yet work with --intermodule-optimization.
# The `override' is needed because otherwise make ignores the assignment if
# EXTRA_MCFLAGS is set on the command line, as it is for the nightly tests.
override EXTRA_MCFLAGS += --no-intermodule-optimization --smart-recompilation \
			--verbose-recompilation

# This module tests recompilation of a module which depends on a module
# for which no version numbers have been computed.
MCFLAGS-no_version_numbers_r_2 = --no-smart-recompilation

$(dates_subdir)nested_module_2_r_2.date: \
				$(int0s_subdir)nested_module_2_r_2.int0

#-----------------------------------------------------------------------------#
